<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Javascript Search Engine : Analyzers testing</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>

<script type="text/javascript" src="../../src/unicode/categ_letters_numbers.js"></script>
<script type="text/javascript" src="../../src/unicode/normalizer_lowercase_nomark.js"></script>
<script type="text/javascript" src="../../src/unicode/unicode.js"></script>

<script type="text/javascript" src="../../src/analyzers.js"></script>
<script type="text/javascript" src="../../src/normalizers.js"></script>
<script type="text/javascript" src="../../src/normalizers/english/metaphone.js"></script>
<script type="text/javascript" src="../../src/utils.js"></script>
<script type="text/javascript" src="../../src/engine.js"></script>
<script type="text/javascript" src="../../src/resultsets.js"></script>
<script type="text/javascript" src="../../src/stores/memory_store.js"></script>

<script type="text/javascript" src="animals.js"></script>

<style TYPE="text/css">

div.floatbox {
	float:left; width: 300px;
}
div.resultbox {
	border: 1px solid black; margin:0.5em;
	color: black; background-color: #EEEEEE;
	overflow: hidden;
}
textarea.typebox {
	float: left;
	width: 300px; height: 200px; margin:1em;"
	color: black; background-color: white;
}
</style>
</head>
<body>
<h1>Animal Database</h1>

<div>
This application provides an example of fulltext search in the species database from
the <a href="http://gapanalysis.usgs.gov/data/species-data/">U.S. Geological Survey Gap Analysis Program</a>
</div>

<div style="display: none;" id="application">
	Type an animal name here:
	<div>
		<input type="text" id="typehere" class="typebox">
		<button id="search">Search</button>
	</div>
	<div style="clear:both" id="results">
	</div>
</div>
<div id="loading">
Application is loading
</div>
<script type="text/javascript">

$(document).ready(function() {

	Animals.start(function(i)Â {
		console.log("start, i="+i+" == " + (i==true));
		if (i) {
			$("#loading").hide();
			$("#application").show();
		}
	});

	var now = (function() {
		var perf = window.performance || {};
		var fn = perf.now || perf.mozNow || perf.webkitNow || perf.msNow || perf.oNow;
		// fn.bind will be available in all the browsers that support the advanced window.performance... ;-)
		return fn ? fn.bind(perf) : function() { return new Date().getTime(); };
		})();

	function search() {
		var value = $("#typehere").val();
		
		var startTime = now();
		
		Animals.lookup(value, function(result) {
			var time = now() - startTime;
			time = time.toFixed(3);
			result = "<div>Request processed in " + time + " ms</div>" + result;
			$("#results").html(result);
		});
	}

	$("#search").click(search);
	$("#typehere").change(search);
	
	var tests = ["hello", "rodrigo", "ghost"];
	new fullproof.ResultSet().setDataUnsafe(tests).forEach(function(word) {
		console.log("WORD: " + word + " = " + fullproof.english.metaphone()(word) );
	});
	
});</script>
</body>
</html>